@{
    ViewData["Title"] = "RSA Encryption & Decryption";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<div class="container mt-4">
    <div class="card shadow-sm p-3" style="max-width: 700px; margin: auto; font-size: 0.9rem;">
        <h4 class="text-center text-primary mb-3"> RSA Encryption & Decryption</h4>

        @if (TempData["Error"] != null)
        {
            <div class="alert alert-danger py-2">@TempData["Error"]</div>
        }

        @if (TempData["Info"] != null)
        {
            <div class="alert alert-info py-2">@TempData["Info"]</div>
        }

        <form method="post" asp-action="Encrypt">
            <div class="mb-2">
                <label class="form-label fw-semibold">Text to Encrypt</label>
                <textarea class="form-control form-control-sm" name="inputText" rows="2" required></textarea>
            </div>

            <div class="mb-2 position-relative">
                <label class="form-label fw-semibold">Public Key</label>
                <textarea class="form-control form-control-sm" name="publicKey" rows="3" id="publicKey">@TempData["PublicKey"]</textarea>
                <button type="button" class="btn btn-dark btn-sm position-absolute top-0 end-0 mt-1 me-1" onclick="copyToClipboard('publicKey')">
                    <i class="fa-solid fa-copy"></i>
                </button>
            </div>

            <button class="btn btn-sm w-100 mb-2" style="background-color: #2C3E50; color: #ECF0F1;" type="submit">Encrypt</button>
        </form>

        <form method="post" asp-action="Decrypt">
            <div class="mb-2">
                <label class="form-label fw-semibold">Encrypted Text</label>
                <textarea class="form-control form-control-sm" name="encryptedText" rows="2" required></textarea>
            </div>

            <div class="mb-2 position-relative">
                <label class="form-label fw-semibold">Private Key</label>
                <textarea class="form-control form-control-sm" name="privateKey" rows="3" id="privateKey">@TempData["PrivateKey"]</textarea>
                <button type="button" class="btn btn-dark btn-sm position-absolute top-0 end-0 mt-1 me-1" onclick="copyToClipboard('privateKey')">
                    <i class="fa-solid fa-copy"></i>
                </button>
            </div>

            <button class="btn btn-sm w-100 mb-2" style="background-color: #34495E; color: #ECF0F1;" type="submit">Decrypt</button>
        </form>

        <form method="post" asp-action="GenerateKeys">
            <button class="btn btn-secondary btn-sm w-100 mb-3" type="submit">Generate RSA Keys</button>
        </form>

        @if (TempData["Result"] != null)
        {
            <div class="alert alert-success py-2 position-relative">
                <label class="fw-bold mb-1">Result:</label>
                <textarea class="form-control form-control-sm" id="resultText" readonly rows="2">@TempData["Result"]</textarea>
                <button type="button" class="btn btn-dark btn-sm position-absolute top-0 end-0 mt-1 me-1" onclick="copyToClipboard('resultText')">
                    <i class="fa-solid fa-copy"></i>
                </button>
            </div>
        }
    </div>
</div>

<script>
    function copyToClipboard(id) {
        const element = document.getElementById(id);
        element.select();
        element.setSelectionRange(0, 99999);
        document.execCommand("copy");
        alert("Copied to clipboard!");
    }
</script>
